<!--
    ========================================================================
                                PlantUML Build File
    ========================================================================
    Product:       PlantUML - A free UML diagram generator
    Project Info:  https://plantuml.com

    Copyright Information:
    (C) Copyright 2009-2023, Arnaud Roques

    Contributors:
    - Original Author:  Arnaud Roques
    - Script Author: Ilya V. Paramonov

    ============================== Description ==============================

    This build file offers an alternative method to build PlantUML.

    While PlantUML is typically built using Gradle, this Ant build script
    provides a fallback option for those who prefer or only have access to
    Ant.

    Usage:
    To build using this file, navigate to the directory containing this
    build.xml and run "ant" in the command line. For more detailed build
    instructions and requirements, refer to:
    https://github.com/plantuml/plantuml/blob/master/BUILDING.md
    ========================================================================
-->
<project name="PlantUML" default="dist" basedir=".">
    <description>
        PlantUML Build File
    </description>

    <!-- Compile source code and copy necessary files -->
    <target name="compile">
        <!-- Prepare the build directory -->
        <delete dir="build" />
        <mkdir dir="build" />

        <!-- Compile Java sources -->
        <javac target="1.8" source="1.8" srcdir="src" destdir="build" debug="on" encoding="UTF-8">
            <exclude name="test/**" />
        </javac>

        <!-- Copy resources. Grouped by type and directory for better clarity -->
        <copy todir="build/net/sourceforge/plantuml/version">
            <fileset dir="src/main/java/net/sourceforge/plantuml/version">
                <include name="*.png" />
            </fileset>
        </copy>

        <copy todir="build">
            <fileset dir="src/main/resources"/>
        </copy>
    </target>


    <!-- Create distribution JAR and clean up -->
    <target name="dist" depends="compile">
        <!-- Prepare the distribution directory -->
        <delete dir="dist" />
        <mkdir dir="dist" />

        <!-- Create JAR with required attributes in the manifest -->
        <jar jarfile="plantuml.jar" basedir="build">
            <manifest>
                <attribute name="Automatic-Module-Name" value="net.sourceforge.plantuml" />
                <attribute name="Main-Class" value="net.sourceforge.plantuml.Run" />
            </manifest>
        </jar>

        <!-- Clean up the build and distribution directories -->
        <delete dir="build" />
        <delete dir="dist" />
    </target>

</project>
